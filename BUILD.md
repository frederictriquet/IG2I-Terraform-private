# Build Instructions

This repository uses [Marp](https://marp.app/) to convert `cours.md` into presentations and PDFs.

## Prerequisites

### For HTML and Slides PDF
- Node.js (v18 or later)
- npm

### For Continuous PDF (additional)
- [Pandoc](https://pandoc.org/installing.html)
- LaTeX (XeLaTeX)

**Installation:**
```bash
# macOS
brew install pandoc
brew install --cask mactex-no-gui

# Ubuntu/Debian
sudo apt-get install pandoc texlive-xetex texlive-fonts-recommended

# RHEL/CentOS/Fedora
sudo yum install pandoc texlive-xetex texlive-collection-fontsrecommended
```

## Quick Start

```bash
# Install dependencies
npm install

# Build HTML presentation
npm run build

# Build slide-based PDF
npm run build:pdf

# Build continuous PDF (no slide breaks)
npm run build:continuous

# Build everything
npm run build:all
```

## Available Build Scripts

### Development

- `npm run serve` - Start local server with live reload
- `npm run preview` - Open preview in browser
- `npm run build:watch` - Watch for changes and rebuild HTML

### Production

- `npm run build` - Build HTML presentation (`cours.html`)
- `npm run build:pdf` - Build slides PDF (`cours-slides.pdf`)
- `npm run build:continuous` - Build continuous PDF without slide breaks (`cours-continuous.pdf`)
- `npm run build:all` - Build all formats (HTML + both PDFs)
- `npm run build:dir` - Build for GitHub Pages deployment

## Output Files

| File | Description |
|------|-------------|
| `cours.html` | Interactive HTML presentation with slide navigation |
| `cours-slides.pdf` | PDF with slide breaks (one slide per page) |
| `cours-continuous.pdf` | PDF without slide breaks (continuous document) |

## Continuous PDF

The continuous PDF is generated by:
1. Removing all slide separators (`---`)
2. Setting `paginate: false` in the front matter
3. Converting to PDF with natural page breaks

This is useful for:
- Printing as a complete document
- Reading without slide context
- Archiving or sharing as a standard document

## CI/CD

The GitHub Actions workflow automatically builds all formats on push to `master`:
- Deploys HTML to GitHub Pages
- Makes both PDFs available for download

See `.github/workflows/marp-to-pages.yml` for details.

## Manual Build Script

You can also use the shell scripts directly:

```bash
# Build HTML slides
./build.sh

# Build continuous PDF
./build-continuous-pdf.sh

# Build with options
./build.sh --serve     # Local server
./build.sh --preview   # Open in browser
./build.sh --watch     # Watch mode
```

## Troubleshooting

### Images not showing in PDF

Add `--allow-local-files` flag:
```bash
npx @marp-team/marp-cli cours.md --pdf --allow-local-files -o output.pdf
```

### SVG images not rendering

Ensure SVG files are:
- Valid SVG format
- Using relative paths
- Located in the repository

### Build fails in CI

Check that:
- All image paths are correct
- No absolute file paths are used
- `images/` directory is committed to git
